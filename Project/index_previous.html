<html>
<script src='https://d3js.org/d3.v5.min.js'></script>

<style>
body {font: 11px sans-serif;}
circle {fill: lightblue; stroke: black;}
.axis path,
.axis line {
  fill: none;
  stroke: black;
}
.tooltip {
  position: absolute;
  width: 200px;
  height: 28px;
  pointer-events: none;
}

</style>
<body onload='init()'>

<button id="myBtn">TryIt </button>
<svg width=960 height=500>
</svg>

<p>Show Labels
	<select id="label-option">
	<option value="all">All</option>
	<option value="9E">9E</option>
	<option value="AA">AA</option>
	
</p>


<script>
async function init() {
   const data = await d3.csv(
     'airline_delay_May_June_2018.csv');

	
	var margin = {top: 50, right: 50, bottom: 50, left: 50},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

	
    console.log(d3.max(data, function(d) { return Number(d.count_ontime); }));
	console.log('----');
	
	var cValue = function(d) { return d.carrier_name;},
    color = d3.scaleOrdinal(d3.schemeCategory10);
	
	var xmax = d3.max(data, function(d) { return Number(d.total_lateminutes); })
	var ymax = d3.max(data, function(d) { return Number(d.count_ontime); })
	console.log("xmax = " + xmax)
	console.log("ymax = " + ymax)
	var xvalues = d3.scaleLinear().domain([0, xmax]).range([0,width]);
	var yvalues = d3.scaleLinear().domain([0,ymax]).range([height, 0]);
	
    var ylabels = d3.scaleLinear().domain([0,ymax]).range([height, 0]);
	var xlabels = d3.scaleLinear().domain([0, xmax]).range([0,width]);

    var yScale = d3.scaleLinear().domain([0,ymax]).range([height, 0]);
	var xScale = d3.scaleLinear().domain([0,xmax]).range([0, width]);
	
		// add the tooltip area to the webpage
	var tooltip = d3.select("body").append("div")
		.attr("class", "tooltip")
		.style("opacity", 0);
	
	d3.select('body').select('svg').append('g')
	 .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
	 .attr("width", width + margin.left + margin.right)
     .attr("height", height + margin.top + margin.bottom)
     .selectAll('circle')
        .data(data)
        .enter()
		.append('circle')
		.attr("cx", function(d) { console.log(d.total_lateminutes); return xvalues((d.total_lateminutes)); })
		.attr("cy", function(d) { return yvalues((d.count_ontime)); })
        .attr("r", function(d,i) { console.log(d.count_ontime); return ( 2 ); })
		.style("fill", function(d) { return color(cValue(d));})
				.on("mouseover", function(d) {
			tooltip.transition()
			.duration(300)
               .style("opacity", 1);
          tooltip.html(d["airport_name"] + "<br/> (" + d.total_lateminutes
	        + ", " + d.count_ontime + ")")
               .style("left", (d3.event.pageX + 5) + "px")
               .style("top", (d3.event.pageY - 28) + "px");
      })
    .on("mouseout", function() { tooltip.style("opacity", 0) })
		

	//create y-axis
	d3.select("svg")
		.append("g")
		.attr("transform", "translate(50,50)")
		.call(d3.axisLeft(yScale))
		//.call(d3.axisLeft(ylogScale).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")) )
	
	//create x-axis
	d3.select("svg")
		.append("g")
		.attr("transform", "translate(50,450)")
		.call(d3.axisBottom(xScale).tickValues([xmax/4, xmax/2, 3*xmax/4, xmax]).tickFormat(d3.format("~s")) )
		
		
	

}
document.getElemetById("myBtn").addEventListener("click", myFunction);

	function myFunction(){
	 alert("hello world");
	 }	



</script>
</body>
</html>